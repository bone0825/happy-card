<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
                xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
                layout:decorate="~{layouts/default_layout}">
    <th:block layout:fragment="css">
        <link rel="stylesheet" href="/css/card.css" />
    </th:block>

    <div class="content" layout:fragment="content">
        <div class="information">
            <i class="bi bi-postcard-heart"></i>
            <span>새해 복 많이 받으세요 !</span>
        </div>

        <div>
            <img th:src="@{'/img/00' + ${card_id} + '.png'}" th:alt="${card_id} + 'image'">
        </div>
        <form th:action="@{/write-card/{id}(id = ${card_id})}" method="post" id = "f1">
        <div>
            <textarea id="autoResizeTextarea" name="write_content" rows="5" oninput="autoResize(this)"></textarea>
        </div>
            <div>
            <input type="hidden" name="id" th:value="${card_id}">
            </div>
            <div>
            <button type="submit" class="btn btn-primary subbtn">Submit</button>
        </div>
        </form>
        <script th:inline="javascript">

            const formObj = document.querySelector("#f1")
            document.querySelector(".subbtn").addEventListener("click",function (e){
                e.preventDefault()
                e.stopPropagation()

                formObj.method = 'post'
                formObj.submit()
            }, false)
            function autoResize(textarea) {

                if(textarea.scrollHeight>textarea.clientHeight){
                    console.log("+++")
                    textarea.style.height = textarea.scrollHeight+"px";
                }
                else{
                    if(textarea.scrollHeight > 106){
                        console.log("---")
                        textarea.style.height = (textarea.scrollHeight-24) + "px"
                        autoResize(textarea);
                    }
                }
            }

            // 페이지 로드 시 초기 호출
            window.addEventListener('load', function() {
                autoResize(document.getElementById('autoResizeTextarea'));
            });
        </script>
    </div>
</html>